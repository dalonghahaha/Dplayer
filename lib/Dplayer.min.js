function Dplayer(e){this.config=this.build_config(e),this.check_config()&&(this.runtime=this.build_runtime(),this.init())}Dplayer.prototype.build_config=function(e){var t={debug:!1,theme:null,container:null,width:0,height:0,id:null,autoplay:!1,multiple:!1,src:null,thumb:null,playlist:[],playlist_aysnc:!1,playlist_url:null};if(e)for(var i in e)t[i]=e[i];return t},Dplayer.prototype.build_runtime=function(){var e={container:null,video:null,video_container:null,frame:null,fullscreening:!1,playing:!1,progressing:!1,playlist:[],play_index:0,play_definition:""};return this.config.multiple&&(e.playlist=this.config.playlist),e},Dplayer.prototype.check_config=function(){if(this.config.multiple){if(!this.config.playlist)return this.error("视频源配置错误"),!1}else if(!this.config.src)return this.error("视频源配置错误"),!1;return this.config.playlist_aysnc&&!this.config.playlist_url?(this.error("视频源配置错误"),!1):!0},Dplayer.prototype.init=function(){if(this.config.id||(this.config.id="Dplayer_"+(new Date).getTime()+Math.floor(100*Math.random())),this.config.theme){var e=this.css_link(this.config.theme);this.css_ready(e,this.on_theme_ready.bind(this))}else this.build_player()},Dplayer.prototype.on_theme_ready=function(){this.debug("播放器皮肤加载完毕"),this.build_player()},Dplayer.prototype._class={BASE:"Dplayer",VIDEO:"video",CONTROL_BAR:"control-bar",HIDDEN:"hidden",VIDEO_MASK:"video-mask",VIDEO_MASK_ABOUT:"video-mask-about",VIDEO_MASK_TEXT:"video-mask-text",PROGRESS_CONTROL_BAR:"progress-control-bar",PROGRESS_BAR:"progress-bar",TIME_BAR:"time-bar",BUFFER_BAR:"buffer-bar",KNOB_BAR:"knob-bar",BUTTON_BAR:"button-bar",LEFT_GROUP:"left-group",RIGHT_GROUP:"right-group",ICON_BASE:"icon",ICON_LEFT:"icon-left",ICON_RIGHT:"icon-right",LABEL_TEXT:"label-text",ICON_SWITCH:"icon-switch",ICON_PLAY:"icon-play",ICON_PAUSE:"icon-pause",ICON_FORWARD:"icon-step-forward",ICON_BACKWARD:"icon-step-backward",LABEL_POSITION:"label-position",LABEL_DURATION:"label-duration",ICON_RESIZE:"icon-resize",ICON_FULLSCREEN:"icon-fullscreen",ICON_EXITFULLSCREEN:"icon-resize-small",ICON_VOLUME:"icon-volume",ICON_VOLUME_OFF:"icon-volume-off",ICON_VOLUME_UP:"icon-volume-up",ICON_SETTING:"icon-cog",VOLUME_CONTROL_BAR:"volume-control-bar",VOLUME_PROGRESS_BAR:"volume-progress-bar",VOLUME_BAR:"volume-bar",VOLUME_KNOB_BAR:"volume-knob-bar",DEFINITION_BAR:"definition-bar",DEFINITION_LABEL:"definition-label",DEFINITION_PANEL:"definition-panel",DEFINITION_OPTION:"definition-option",DEFINITION_OPTION_LAST:"definition-option-last",DEFINITION_OPTION_SELECTED:"definition-option-selected"},Dplayer.prototype._event=["ready","resize","play","pause","complete"],Dplayer.prototype.on=function(e,t){this.index_of(this._event,e)?t&&t instanceof Function?this["on_player_"+e]=t:this.error("注册函数参数错误"):this.warn("该事件不支持")},Dplayer.prototype.debug=function(e){this.config.debug&&(e instanceof Object?console.log("Dplayer【%s】:%o",this.format_date(new Date,"yyyy-M-dd hh:mm:ss S"),e):console.log("Dplayer【%s】:%s",this.format_date(new Date,"yyyy-M-dd hh:mm:ss S"),e))},Dplayer.prototype.error=function(e){e instanceof Object?console.error("Dplayer【%s】:%o",this.format_date(new Date,"yyyy-M-dd hh:mm:ss S"),e):console.error("Dplayer【%s】:%s",this.format_date(new Date,"yyyy-M-dd hh:mm:ss S"),e)},Dplayer.prototype.warn=function(e){e instanceof Object?console.warn("Dplayer【%s】:%o",this.format_date(new Date,"yyyy-M-dd hh:mm:ss S"),e):console.warn("Dplayer【%s】:%s",this.format_date(new Date,"yyyy-M-dd hh:mm:ss S"),e)},Dplayer.prototype.index_of=function(e,t){var i=e.join();return i.indexOf(t)>=0},Dplayer.prototype.format_time=function(e){var t=[parseInt(e/60/60),parseInt(e/60%60),e%60].join(":");return t.replace(/\b(\d)\b/g,"0$1")},Dplayer.prototype.format_percent=function(e,t){return t?Math.round(e/t*1e4)/100:0},Dplayer.prototype.format_date=function(e,t){var i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var s in i)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[s]:("00"+i[s]).substr((""+i[s]).length)));return t},Dplayer.prototype.get_offset_x=function(e,t){var i=e.clientX-t.getBoundingClientRect().left;return parseInt(i)},Dplayer.prototype.get_offset_y=function(e,t){var i=e.clientY-t.getBoundingClientRect().top;return parseInt(i)},Dplayer.prototype.has_class=function(e,t){return t=t||"",0==t.replace(/\s/g,"").length?!1:new RegExp(" "+t+" ").test(" "+e.className+" ")},Dplayer.prototype.add_class=function(e,t){this.has_class(e,t)||(e.className=""==e.className?t:e.className+" "+t)},Dplayer.prototype.remove_class=function(e,t){if(this.has_class(e,t)){for(var i=" "+e.className.replace(/[\t\r\n]/g,"")+" ";i.indexOf(" "+t+" ")>=0;)i=i.replace(" "+t+" "," ");e.className=i.replace(/^\s+|\s+$/g,"")}},Dplayer.prototype.async_get=function(e,t,i){this.debug(t);var s=new XMLHttpRequest;if(!s)return this.error("Ajax请求初始化失败!"),!1;s.responseType="json",s.onreadystatechange=function(){switch(s.readyState){case 1:this.debug("ajax打开，准备上传");break;case 4:200==s.status?(this.debug("ajax 收到服务器端数据"),this.debug(s.response),s.response?i(s.response):this.error("ajax返回格式错误")):this.error("上传过程出现错误,状态:"+s.status)}}.bind(this),s.error=function(){this.error("提交过程出现错误")}.bind(this),e+="?time="+(new Date).getTime();for(var n in t)e+="&"+n+"="+t[n];s.open("GET",e,!0),s.send(null)},Dplayer.prototype.async_post=function(e,t,i){this.debug(t);var s=new XMLHttpRequest;if(!s)return this.error("Ajax请求初始化失败!"),!1;s.responseType="json",s.onreadystatechange=function(){switch(s.readyState){case 1:this.debug("ajax打开，准备上传");break;case 4:200==s.status?(this.debug("ajax 收到服务器端数据"),i(s.response)):this.error("上传过程出现错误,状态:"+s.status)}}.bind(this),s.error=function(){this.error("提交过程出现错误")}.bind(this);var n=new FormData;if(n){for(var r in t)n.append(r,t[r]);s.open("POST",e,!0),s.send(n)}else this.error("提交过程出现错误")},Dplayer.prototype.css_link=function(e){var t=document.getElementsByTagName("head")[0],i=document.createElement("link");return i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.href=e,t.appendChild(i),i},Dplayer.prototype.css_ready=function(e,t){function i(){try{return e&&e[o]&&e[o][r]&&e[o][r][0]}catch(t){return!1}}var s=document,n=s.createStyleSheet,r=n?"rules":"cssRules",o=n?"styleSheet":"sheet",a=s.getElementsByTagName("link");e||(e=a[a.length-1]),function l(){i()&&setTimeout(t,0)||setTimeout(l,100)}()},Dplayer.prototype.create_element=function(e,t){var i=document.createElement("div");return i.className=e instanceof Array?e.join(" "):e,t&&(i.innerText=t),i},Dplayer.prototype.query_element=function(e){if(e){var t="."+e,i=document.querySelector(t);return i.has_class=function(e){return 0==e.replace(/\s/g,"").length?!1:new RegExp(" "+e+" ").test(" "+this.className+" ")},i.add_class=function(e){this.has_class(e)||(this.className=""==this.className?e:this.className+" "+e)},i.remove_class=function(e){if(this.has_class(e)){for(var t=" "+this.className.replace(/[\t\r\n]/g,"")+" ";t.indexOf(" "+e+" ")>=0;)t=t.replace(" "+e+" "," ");this.className=t.replace(/^\s+|\s+$/g,"")}},i}return null},Dplayer.prototype.build_player=function(){this.runtime.container=document.getElementById(this.config.container),this.runtime.frame=this.create_element(this._class.BASE),this.runtime.frame.style.width=this.config.width+"px",this.runtime.frame.appendChild(this.build_video()),this.runtime.frame.appendChild(this.build_control_bar()),this.runtime.container.appendChild(this.runtime.frame),setTimeout(this.on_player_build.bind(this),100)},Dplayer.prototype.build_video=function(){return this.runtime.video_container=this.create_element(this._class.VIDEO),this.runtime.video_container.style.width=this.config.width+"px",this.runtime.video_container.style.height=this.config.height+"px",this.runtime.video=document.createElement("video"),this.runtime.video.width=this.config.width,this.runtime.video.height=this.config.height,this.init_src(),this.init_poster(),this.runtime.video_container.appendChild(this.runtime.video),this.runtime.video_container.appendChild(this.build_video_mask()),this.runtime.video_container},Dplayer.prototype.build_video_mask=function(){var e=this.create_element(this._class.VIDEO_MASK);return e.appendChild(this.build_context_menu()),e},Dplayer.prototype.build_context_menu=function(){var e=this.create_element([this._class.VIDEO_MASK_ABOUT,this._class.HIDDEN]),t=this.create_element(this._class.VIDEO_MASK_TEXT,"名称:Dplayer");t.setAttribute("action","http://www.Dplayer.com"),e.appendChild(t);var i=this.create_element(this._class.VIDEO_MASK_TEXT,"版本:1.0.0");i.setAttribute("action","http://www.Dplayer.com"),e.appendChild(i);var s=this.create_element(this._class.VIDEO_MASK_TEXT,"作者:龙翔云际");if(s.setAttribute("action","http://dalong.me"),e.appendChild(s),this.config.about&&this.config.about.length)for(var n=0;n<this.config.about.length;n++){var r=this.create_element(this._class.VIDEO_MASK_TEXT,this.config.about[n].text);r.setAttribute("action",this.config.about[n].link),e.appendChild(r)}return e},Dplayer.prototype.build_control_bar=function(){var e=this.create_element(this._class.CONTROL_BAR);return e.appendChild(this.build_progress_control_bar()),e.appendChild(this.build_button_bar()),e},Dplayer.prototype.build_progress_control_bar=function(){var e=this.create_element(this._class.PROGRESS_CONTROL_BAR),t=this.create_element(this._class.PROGRESS_BAR);return t.appendChild(this.create_element(this._class.BUFFER_BAR)),t.appendChild(this.create_element(this._class.TIME_BAR)),t.appendChild(this.create_element([this._class.KNOB_BAR,this._class.HIDDEN])),e.appendChild(t),e},Dplayer.prototype.build_button_bar=function(){var e=this.create_element(this._class.BUTTON_BAR);return e.appendChild(this.build_button_bar_left()),e.appendChild(this.build_button_bar_right()),e},Dplayer.prototype.build_button_bar_left=function(){var e=this.create_element(this._class.LEFT_GROUP);return e.appendChild(this.create_element([this._class.ICON_BASE,this._class.ICON_PLAY,this._class.ICON_SWITCH])),this.config.multiple&&(e.appendChild(this.create_element([this._class.ICON_BASE,this._class.ICON_BACKWARD])),e.appendChild(this.create_element([this._class.ICON_BASE,this._class.ICON_FORWARD]))),e.appendChild(this.create_element([this._class.LABEL_TEXT,this._class.LABEL_POSITION],"00:00:00")),e.appendChild(this.create_element([this._class.LABEL_TEXT,this._class.LABEL_SPLITE],"|")),e.appendChild(this.create_element([this._class.LABEL_TEXT,this._class.LABEL_DURATION],"00:00:00")),e},Dplayer.prototype.build_button_bar_right=function(){var e=this.create_element(this._class.RIGHT_GROUP);return e.appendChild(this.create_element([this._class.ICON_BASE,this._class.ICON_VOLUME_UP,this._class.ICON_VOLUME])),e.appendChild(this.build_volume_control_bar()),e.appendChild(this.config.multiple?this.build_definition_control_bar(this.config.playlist[0].src):this.build_definition_control_bar(this.config.src)),e.appendChild(this.create_element([this._class.ICON_BASE,this._class.ICON_SETTING])),e.appendChild(this.create_element([this._class.ICON_BASE,this._class.ICON_FULLSCREEN,this._class.ICON_RESIZE])),e},Dplayer.prototype.build_volume_control_bar=function(){var e=this.create_element(this._class.VOLUME_CONTROL_BAR);return e.appendChild(this.create_element(this._class.VOLUME_PROGRESS_BAR)),e.appendChild(this.create_element(this._class.VOLUME_BAR)),e.appendChild(this.create_element(this._class.VOLUME_KNOB_BAR)),e},Dplayer.prototype.build_definition_control_bar=function(e){var t=this.create_element(this._class.DEFINITION_BAR);t.appendChild(this.create_element(this._class.DEFINITION_LABEL,"清晰度"));var i=this.create_element([this._class.DEFINITION_PANEL,this._class.HIDDEN]);if(e instanceof Array)for(var s=0;s<e.length;s++){var n;n=e[s].index==this.runtime.play_definition?this.create_element(this._class.DEFINITION_OPTION_SELECTED,e[s].name):this.create_element(this._class.DEFINITION_OPTION,e[s].name),n.setAttribute("definition",e[s].index),s==e.length-1&&this.add_class(n,this._class.DEFINITION_OPTION_LAST),i.appendChild(n)}else this.add_class(t,"hidden");return t.appendChild(i),t},Dplayer.prototype.on_player_build=function(){this.debug("播放器初始化完毕"),this.on_player_ready&&this.on_player_ready instanceof Function&&this.on_player_ready(),this.delegate_document_event(),this.delegate_video_event(),this.delegate_control_event(),this.delegate_mask_event(),this.config.autoplay&&this.play()},Dplayer.prototype.delegate=function(e,t,i){var s=this.query_element(this._class.BASE);s.addEventListener(t,function(t){for(var n=t.target||t.srcElement,r=[n.className];n.parentElement&&n!=s;)r.push(n.parentElement.className),n=n.parentElement;if(e){var n=t.target||t.srcElement;this.index_of(r,e)&&i(t)}else i(t);return!1}.bind(this))},Dplayer.prototype.delegate_video_event=function(){this.runtime.video.addEventListener("canplay",this.on_video_canplay.bind(this)),this.runtime.video.addEventListener("progress",this.on_video_progress.bind(this)),this.runtime.video.addEventListener("play",this.on_video_play.bind(this)),this.runtime.video.addEventListener("pause",this.on_video_pause.bind(this)),this.runtime.video.addEventListener("timeupdate",this.on_video_playing.bind(this)),this.runtime.video.addEventListener("ended",this.on_video_ended.bind(this))},Dplayer.prototype.delegate_mask_event=function(){this.delegate(this._class.VIDEO_MASK,"contextmenu",this.on_mask_contextmenu.bind(this)),this.delegate(this._class.VIDEO_MASK_ABOUT,"mouseup",this.on_mask_about_click.bind(this))},Dplayer.prototype.delegate_control_event=function(){this.delegate(this._class.BASE,"mousemove",this.on_control_progress_on.bind(this)),this.delegate(this._class.BASE,"mouseout",this.on_control_progress_off.bind(this)),this.delegate(this._class.PROGRESS_BAR,"mousedown",this.on_control_progress_select.bind(this)),this.delegate(this._class.PROGRESS_BAR,"mouseup",this.on_control_progress_seek.bind(this)),this.delegate(this._class.BASE,"mouseup",this.on_control_progress_selected.bind(this)),this.delegate(this._class.ICON_SWITCH,"mousedown",this.on_control_play.bind(this)),this.delegate(this._class.ICON_FORWARD,"mousedown",this.on_control_forward.bind(this)),this.delegate(this._class.ICON_BACKWARD,"mousedown",this.on_control_backward.bind(this)),this.delegate(this._class.ICON_VOLUME,"mousedown",this.on_control_volume.bind(this)),this.delegate(this._class.VOLUME_CONTROL_BAR,"mouseup",this.on_control_volume_seek.bind(this)),this.delegate(this._class.DEFINITION_BAR,"mouseover",this.on_control_definition_on.bind(this)),this.delegate(this._class.DEFINITION_BAR,"mouseout",this.on_control_definition_off.bind(this)),this.delegate(this._class.DEFINITION_OPTION,"mouseup",this.on_control_definition_change.bind(this)),this.delegate(this._class.ICON_SETTING,"mousedown",this.on_control_setting.bind(this)),this.delegate(this._class.ICON_RESIZE,"mousedown",this.on_control_fullscreen.bind(this))},Dplayer.prototype.delegate_document_event=function(){document.addEventListener("fullscreenchange",this.on_video_fullscreenchange.bind(this)),document.addEventListener("webkitfullscreenchange",this.on_video_fullscreenchange.bind(this)),document.addEventListener("mozfullscreenchange",this.on_video_fullscreenchange.bind(this)),document.addEventListener("MSFullscreenChange",this.on_video_fullscreenchange.bind(this)),document.addEventListener("mouseup",function(){this.runtime.progressing=!1,this.query_element("video-mask-about").add_class("hidden")}.bind(this))},Dplayer.prototype.get_video_src_index=function(e,t){if(!e)return"";for(var i=0;i<e.length;i++)if(t){if(e[i].index==t)return i}else if(e[i]["default"])return i},Dplayer.prototype.init_src=function(){var e;if(e=this.config.multiple?this.runtime.playlist[0].src:this.config.src,e instanceof Array){var t=this.get_video_src_index(e);this.runtime.video.src=e[t].url,this.runtime.play_definition=e[t].index}else this.runtime.video.src=this.config.src},Dplayer.prototype.init_poster=function(){this.config.multiple?this.runtime.playlist[0].thumb&&(this.runtime.video.poster=this.runtime.playlist[0].thumb):this.config.thumb&&(this.runtime.video.poster=this.config.thumb)},Dplayer.prototype.change_src=function(e,t){if(this.runtime.playing){if(this.pause(),t)this.runtime.video.src=e,this.change_buffer(0),this.change_progress(0);else{var i=this.runtime.video.currentTime;this.runtime.video.src=e,this.runtime.video.currentTime=i}this.play()}else this.runtime.video.src=e,this.change_buffer(0),this.change_progress(0)},Dplayer.prototype.play=function(){this.runtime.video.play(),this.runtime.playing=!0,this.query_element(this._class.ICON_SWITCH).remove_class(this._class.ICON_PLAY),this.query_element(this._class.ICON_SWITCH).add_class(this._class.ICON_PAUSE)},Dplayer.prototype.pause=function(){this.runtime.video.pause(),this.runtime.playing=!1,this.query_element(this._class.ICON_SWITCH).remove_class(this._class.ICON_PAUSE),this.query_element(this._class.ICON_SWITCH).add_class(this._class.ICON_PLAY)},Dplayer.prototype.change_play=function(e){this.runtime.playing||(this.runtime.video.poster=this.runtime.playlist[e].thumb?this.runtime.playlist[e].thumb:"");var t=this.runtime.playlist[e].src;if(t instanceof Array){var e=this.get_video_src_index(t),i=t[e].url;this.runtime.play_definition=t[e].index,this.on_definition_panel_rebuild(t),this.change_src(i,!0),this.query_element(this._class.DEFINITION_BAR).remove_class("hidden")}else this.change_src(t,!0),this.query_element(this._class.DEFINITION_BAR).add_class("hidden")},Dplayer.prototype.fullscreen=function(){var e=this.query_element(this._class.BASE);e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},Dplayer.prototype.exitfullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},Dplayer.prototype.resize=function(e,t){this.runtime.frame.style.width=e+"px",this.runtime.frame.style.height=t+"px",this.runtime.video_container.style.width=e+"px",this.runtime.video_container.style.height=t+"px",this.runtime.video.width=e,this.runtime.video.height=t},Dplayer.prototype.change_buffer=function(e){var t=parseInt(this.runtime.video.duration),i=this.format_percent(e,t);this.query_element(this._class.BUFFER_BAR).style.width=i+"%"},Dplayer.prototype.change_progress=function(e){var t=parseInt(this.runtime.video.duration),i=this.format_percent(e,t),s=this.query_element(this._class.PROGRESS_BAR).clientWidth,n=this.query_element(this._class.KNOB_BAR).clientWidth,r=s*i/100;this.query_element(this._class.KNOB_BAR).style.left=n/2>=r?n/2+"px":r>=s-n/2?s-n/2+"px":i+"%",this.query_element(this._class.TIME_BAR).style.width=i+"%"},Dplayer.prototype.change_volume=function(e){this.runtime.video.volume=e/100;var t=this.format_percent(e,100);this.query_element(this._class.VOLUME_KNOB_BAR).style.left=t+"%",this.query_element(this._class.VOLUME_BAR).style.width=t+"%"},Dplayer.prototype.on_video_canplay=function(e){this.debug("视频可以播放");var t=parseInt(this.runtime.video.duration);this.query_element(this._class.LABEL_DURATION).innerText=this.format_time(t)},Dplayer.prototype.on_video_progress=function(e){if(this.runtime.playing){var t=this.runtime.video.buffered;if(t&&t.length){var i=parseInt(t.end(t.length-1));this.change_buffer(i)}}},Dplayer.prototype.on_video_play=function(e){this.debug("视频播放开始"),this.on_player_play&&this.on_player_play instanceof Function&&this.on_player_play()},Dplayer.prototype.on_video_pause=function(e){this.debug("视频播放暂停"),this.on_player_pause&&this.on_player_pause instanceof Function&&this.on_player_pause()},Dplayer.prototype.on_video_playing=function(e){if(!this.runtime.progressing){var t=parseInt(this.runtime.video.currentTime),i=parseInt(this.runtime.video.duration);this.query_element(this._class.LABEL_POSITION).innerText=this.format_time(t),this.query_element(this._class.LABEL_DURATION).innerText=this.format_time(i),this.change_progress(t)}},Dplayer.prototype.on_video_ended=function(e){this.debug("视频播放"),this.runtime.playing=!1,this.query_element(this._class.ICON_SWITCH).remove_class(this._class.ICON_PAUSE),this.query_element(this._class.ICON_SWITCH).add_class(this._class.ICON_PLAY)},Dplayer.prototype.on_video_fullscreenchange=function(e){if(this.runtime.fullscreening)this.debug("视频退出全屏"),this.resize(this.config.width,this.config.height),this.runtime.fullscreening=!1,this.query_element(this._class.ICON_RESIZE).remove_class(this._class.ICON_EXITFULLSCREEN),this.query_element(this._class.ICON_RESIZE).add_class(this._class.ICON_FULLSCREEN);else{this.debug("视频进入全屏");var t=this.query_element(this._class.CONTROL_BAR).clientHeight,i=0,s=0;document.msRequestFullscreen?(i=window.screen.width,s=window.screen.height-t):(i=window.screen.availWidth,s=window.screen.availHeight-t-10),this.resize(i,s),this.runtime.fullscreening=!0,this.query_element(this._class.ICON_RESIZE).remove_class(this._class.ICON_FULLSCREEN),this.query_element(this._class.ICON_RESIZE).add_class(this._class.ICON_EXITFULLSCREEN)}},Dplayer.prototype.on_control_progress_on=function(e){if(this.query_element(this._class.KNOB_BAR).remove_class(this._class.HIDDEN),this.runtime.playing&&this.runtime.progressing){var t=this.get_offset_x(e,this.query_element(this._class.PROGRESS_BAR)),i=this.query_element(this._class.PROGRESS_BAR).clientWidth,s=this.format_percent(t,i),n=parseInt(this.runtime.video.duration),r=parseInt(n*s/100);this.change_progress(r)}},Dplayer.prototype.on_control_progress_off=function(e){this.query_element(this._class.KNOB_BAR).add_class(this._class.HIDDEN)},Dplayer.prototype.on_control_progress_select=function(e){this.runtime.progressing=!0,e.preventDefault()},Dplayer.prototype.on_control_progress_selected=function(e){this.runtime.playing&&this.runtime.progressing&&this.on_control_progress_seek(e)},Dplayer.prototype.on_control_progress_seek=function(e){if(this.runtime.progressing=!1,this.runtime.playing){var t=this.get_offset_x(e,this.query_element(this._class.PROGRESS_BAR)),i=this.query_element(this._class.PROGRESS_BAR).clientWidth,s=this.format_percent(t,i),n=parseInt(this.runtime.video.duration*s/100);this.change_progress(n),this.runtime.video.currentTime=n}return!1},Dplayer.prototype.on_control_play=function(e){this.runtime.playing?this.pause():this.play()},Dplayer.prototype.on_control_forward=function(e){var t=this.runtime.play_index;return this.runtime.playlist[t+1]?(this.change_play(t+1),void(this.runtime.play_index+=1)):(this.error("不存在下一节"),!1)},Dplayer.prototype.on_control_backward=function(e){var t=this.runtime.play_index;return this.runtime.playlist[t-1]?(this.change_play(t-1),void(this.runtime.play_index-=1)):(this.error("不存在上一节"),!1)},Dplayer.prototype.on_control_volume=function(e){this.runtime.video.volume?(this.change_volume(0),this.query_element(this._class.ICON_VOLUME).remove_class(this._class.ICON_VOLUME_UP),this.query_element(this._class.ICON_VOLUME).add_class(this._class.ICON_VOLUME_OFF)):(this.change_volume(100),this.query_element(this._class.ICON_VOLUME).remove_class(this._class.ICON_VOLUME_OFF),this.query_element(this._class.ICON_VOLUME).add_class(this._class.ICON_VOLUME_UP))},Dplayer.prototype.on_control_volume_seek=function(e){var t=this.get_offset_x(e,this.query_element(this._class.VOLUME_CONTROL_BAR)),i=this.query_element(this._class.VOLUME_CONTROL_BAR).clientWidth,s=this.format_percent(t,i);this.change_volume(s)},Dplayer.prototype.on_control_setting=function(e){this.debug("坑爹呢！")},Dplayer.prototype.on_control_fullscreen=function(e){this.runtime.fullscreening?this.exitfullscreen():this.fullscreen()},Dplayer.prototype.on_control_definition_on=function(e){this.query_element(this._class.DEFINITION_PANEL).remove_class(this._class.HIDDEN)},Dplayer.prototype.on_control_definition_off=function(e){this.query_element(this._class.DEFINITION_PANEL).add_class(this._class.HIDDEN)},Dplayer.prototype.on_control_definition_change=function(e){var t=e.target.getAttribute("definition");if(this.runtime.play_definition=t,!t)return this.error("清晰度选择错误"),!1;var i=this.config.multiple?this.config.playlist[this.runtime.play_index].src:this.config.src,s=this.get_video_src_index(i,t),n=i[s].url;this.change_src(n),this.on_definition_panel_rebuild(i)},Dplayer.prototype.on_definition_panel_rebuild=function(e){this.query_element(this._class.DEFINITION_PANEL).innerHTML="";for(var t=0;t<e.length;t++){var i;i=e[t].index==this.runtime.play_definition?this.create_element(this._class.DEFINITION_OPTION_SELECTED,e[t].name):this.create_element(this._class.DEFINITION_OPTION,e[t].name),i.setAttribute("definition",e[t].index),t==e.length-1&&this.add_class(i,this._class.DEFINITION_OPTION_LAST),this.query_element(this._class.DEFINITION_PANEL).appendChild(i)}},Dplayer.prototype.on_mask_contextmenu=function(e){var t=this.get_offset_x(e,this.query_element("video-mask")),i=this.get_offset_y(e,this.query_element("video-mask"));this.query_element(this._class.VIDEO_MASK_ABOUT).style.left=t+"px",this.query_element(this._class.VIDEO_MASK_ABOUT).style.top=i+"px",this.query_element(this._class.VIDEO_MASK_ABOUT).remove_class(this._class.HIDDEN),e.preventDefault()},Dplayer.prototype.on_mask_about_click=function(e){var t=e.target.getAttribute("action");window.open(t),e.preventDefault()};